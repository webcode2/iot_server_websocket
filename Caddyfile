{
    debug
}

iot.codeabs.com {
    # Route WebSocket traffic to the Socket.IO server
    handle_path /socket.io/* {
        reverse_proxy chat_app:3000 {
            header_up Host {host}
            header_up X-Forwarded-For {remote}
            # Enable WebSocket support
            header_up Connection "Upgrade"
            header_up Upgrade "websocket"
        }
    }

    # Route HTTP traffic to the  app
    reverse_proxy app:3000 {
        header_up Host {host}
        header_up X-Forwarded-For {remote}
        header_down Strict-Transport-Security "max-age=31536000;"
    }
}   